spring.application.name=Mattfuncional

# Configuración del puerto
server.port=8080

# Base de datos: mattfuncional (creada en MySQL)
spring.datasource.url=jdbc:mysql://localhost:3306/mattfuncional?createDatabaseIfNotExist=true&useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC
spring.datasource.username=root
spring.datasource.password=root

# Configuración de perfil por defecto - Cambiado a dev para desarrollo local
spring.profiles.active=${SPRING_PROFILES_ACTIVE:dev}

# Configuración básica de JPA y Hibernate
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=false
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.MySQL8Dialect

# Configuración básica de logging
logging.level.org.springframework.web=INFO
logging.level.com.mattfuncional=INFO
logging.level.org.springframework.security=INFO
logging.level.org.hibernate.SQL=INFO
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=INFO

# Configuración básica de archivos
spring.servlet.multipart.max-file-size=100MB
spring.servlet.multipart.max-request-size=200MB
spring.servlet.multipart.file-size-threshold=2MB

# Configuración de almacenamiento de imágenes
# Ruta donde se guardarán las imágenes (relativa al directorio del proyecto)
mattfuncional.uploads.dir=uploads
mattfuncional.uploads.ejercicios=ejercicios
mattfuncional.uploads.base-url=/img

# Configuración básica de caché
spring.cache.type=caffeine
spring.cache.caffeine.spec=maximumSize=200,expireAfterWrite=300s

# Configuración básica de pool de conexiones
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
spring.datasource.hikari.max-lifetime=1800000
spring.datasource.hikari.validation-timeout=5000
spring.datasource.hikari.connection-test-query=SELECT 1

# Configuración básica de sesión (tiempo sin actividad tras el cual se cierra sesión)
# 30m = 30 minutos; el profesor debe volver a iniciar sesión si no toca nada
server.servlet.session.timeout=30m

# Configuración básica de Tomcat
server.tomcat.connection-timeout=60s
server.tomcat.max-threads=50
server.tomcat.min-spare-threads=10
server.tomcat.max-connections=200
server.tomcat.accept-count=50

# Configuración básica de health check
management.endpoints.web.exposure.include=health,info
management.endpoint.health.show-details=never
management.health.db.enabled=true
management.health.diskspace.enabled=true

# ===== SPRING BOOT DEVTOOLS CONFIGURACIÓN =====
# Habilitar restart automático para desarrollo
spring.devtools.restart.enabled=true
spring.devtools.livereload.enabled=true

# Configurar archivos que NO deben trigger restart
spring.devtools.restart.exclude=static/**,public/**,templates/**,META-INF/maven/**,META-INF/resources/**,WEB-INF/**

# Configurar archivos que SÍ deben trigger restart
spring.devtools.restart.additional-paths=src/main/java

# Configurar polling para detectar cambios (útil en algunos IDEs)
spring.devtools.restart.poll-interval=2s
spring.devtools.restart.quiet-period=1s

# Configurar livereload
spring.devtools.livereload.port=35729
